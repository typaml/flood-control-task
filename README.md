
# Что нужно сделать

Реализовать интерфейс с методом для проверки правил флуд-контроля. Если за последние N секунд вызовов метода Check будет больше K, значит, проверка на флуд-контроль не пройдена.

- Интерфейс FloodControl располагается в файле main.go.

- Флуд-контроль может быть запущен на нескольких экземплярах приложения одновременно, поэтому нужно предусмотреть общее хранилище данных. Допустимо использовать любое на ваше усмотрение. 

# Необязательно, но было бы круто

Хорошо, если добавите поддержку конфигурации итоговой реализации. Параметры — на ваше усмотрение.




Изначально, нам необходимо создать общее хранилище данных, где мы будем хранить запросы наших клиентов и время выполнения этого запроса. В данной задаче я решил, что можно воспользоваться SQLite.

Определил структуру базы данных и функцию создания и инициализации БД.

Далее необходимо было написать сам метод Check(). Изначально была мысль о том, что нам необходимо брать время текущее и отправлять его в бд. Также необходимо получать кол-во записей у клиента, которые не превышают допустимого времени.

В том числе, позднее, подумал, что необходимо удалять ненужные запросы и освобождать память, ускорять работу программы - добавил удаление записей старше N+1 секунды, чтобы не ошибиться с удалением, в некоторые моменты - у нас будут храниться ненужные нам записи(которые превышают N), но таким образом, я считаю, что мы не рискуем потерять какой-нибудь запрос, который был отправлен секунда в секунду (возможно, я не прав).

Далее я столкнулся с ошибкой блокировки базы данных из-за того что не закрыл запрос - rows.Close(), ища ошибку с своем коде, я добавил пинг в функцию инизиализации бд, чтобы у нас открывалось соединение с ней.

Последнее, что осталось - это инициализировать контекст, базу данных и дернуть check - обработать возможные варианта возврата этой функции.

В дальнейшем, т.к. у меня оставалось ещё время, я решил сделать конфиг, но ничего более, чем путь бд и тайм-аут для запросов я не придумал в аргументы, можно было добавить env, но его было бы необходимо обрабатывать - в контексте данной задачи это не имеет смысла, в том числе попытался в конфиг вынести значения макс. кол-во вызовов и кол-во секунд, но не смог реализовать их в дальнейшем в методе Check, поэтому ограничился только двумя параметрами. 

Задачка показалсь мне очень интересной, я впервые работал с контекстом, поэтому пришлось в быстрые сроки узнавать и разбираться как это работает и какие возможности он предоставляет для работы с БД. Не буду отрицать, что, возможно, работа с контекстом проведена не верно и необходимо было использовать контекст по другому, опять таки повторюсь - контекст использовал первый раз и буду рад услышать обратную связь по данному заданию.

В целом, наверное, других вариантов решения я не рассматривал, т.к. двигался по этому направлению и делал то, что считаю правильным. Как и написал выше, буду рад обратной связи и конструктивной критике.
